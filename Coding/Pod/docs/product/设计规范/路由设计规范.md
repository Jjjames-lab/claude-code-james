# è·¯ç”±è®¾è®¡è§„èŒƒ

**ç‰ˆæœ¬**: v2.1.0
**æœ€åæ›´æ–°**: 2026-01-29
**æŠ€æœ¯æ–¹æ¡ˆ**: React Router v6

---

## ğŸ“‹ è·¯ç”±ç»“æ„æ€»è§ˆ

```
/                           â†’ InputPageï¼ˆè¾“å…¥é¡µé¢ï¼‰
/podcast/:id                â†’ PodcastDetailPageï¼ˆæ’­å®¢è¯¦æƒ…é¡µï¼‰
/episode/:id                â†’ EpisodeTabPageï¼ˆTab åŠŸèƒ½é¡µï¼‰
/search                     â†’ SearchPageï¼ˆæœç´¢é¡µï¼Œè®¡åˆ’ä¸­ï¼‰
```

---

## ğŸ”„ è·¯ç”±è®¾è®¡åŸåˆ™

### 1. ç”¨æˆ·ä½“éªŒä¼˜å…ˆ
- âœ… URL å¯è¯»æ€§å¼ºï¼ˆ`/podcast/xxx` è€Œé `/?type=podcast&id=xxx`ï¼‰
- âœ… æ”¯æŒæµè§ˆå™¨å‰è¿›/åé€€
- âœ… å¯ç›´æ¥åˆ†äº« URL
- âœ… åˆ·æ–°é¡µé¢ä¸ä¸¢å¤±æ•°æ®

### 2. æŠ€æœ¯å®ç°
- âœ… ä½¿ç”¨ React Router v6
- âœ… å®¢æˆ·ç«¯è·¯ç”±ï¼ˆéæœåŠ¡ç«¯æ¸²æŸ“ï¼‰
- âœ… Lazy Loading ä¼˜åŒ–æ€§èƒ½
- âœ… è·¯ç”±çº§åˆ«çš„ä»£ç åˆ†å‰²

### 3. æ•°æ®ç®¡ç†
- âœ… URL å‚æ•°ä¼ é€’ ID
- âœ… è¯¦ç»†æ•°æ®ä» API è·å–
- âœ… LocalStorage ç¼“å­˜å·²å¤„ç†æ•°æ®
- âœ… é¿å…é‡å¤è¯·æ±‚

---

## ğŸ“„ é¡µé¢å®šä¹‰

### 1. InputPageï¼ˆè¾“å…¥é¡µé¢ï¼‰
**è·¯ç”±**: `/`
**ç”¨é€”**: ç”¨æˆ·è¾“å…¥å°å®‡å®™é“¾æ¥

**åŠŸèƒ½**:
- URL è¾“å…¥æ¡†
- é“¾æ¥ç±»å‹æ£€æµ‹ï¼ˆepisode / podcastï¼‰
- å†å²è®°å½•å…¥å£
- å¯¼èˆªæŒ‰é’®

**çŠ¶æ€ç®¡ç†**:
```typescript
appState: 'input'
```

**å¯¼èˆªè¡Œä¸º**:
- è¾“å…¥å•é›†é“¾æ¥ â†’ å¯¼èˆªåˆ° `/episode/:id`
- è¾“å…¥æ’­å®¢é“¾æ¥ â†’ å¯¼èˆªåˆ° `/podcast/:id`

---

### 2. PodcastDetailPageï¼ˆæ’­å®¢è¯¦æƒ…é¡µï¼‰
**è·¯ç”±**: `/podcast/:id`
**ç”¨é€”**: æ˜¾ç¤ºæ’­å®¢ä¿¡æ¯å’Œæœ€æ–°èŠ‚ç›®æ¸…å•

**åŠŸèƒ½**:
- æ’­å®¢ Logoã€åç§°ã€ä¸»æ’­ã€ä»‹ç»
- æœ€æ–° 5 æœŸèŠ‚ç›®åˆ—è¡¨
- æ¯é›†å¤„ç†çŠ¶æ€æ˜¾ç¤º
- ç‚¹å‡»æŸä¸€é›† â†’ å¯¼èˆªåˆ° `/episode/:episodeId`

**URL å‚æ•°**:
```typescript
{
  id: string  // æ’­å®¢ IDï¼ˆä» URL è§£æï¼‰
}
```

**æ•°æ®æ¥æº**:
```typescript
// API è°ƒç”¨
GET /api/crawler/parse-podcast
Request: { url: "https://www.xiaoyuzhoufm.com/podcast/xxx" }
Response: { podcast_id, podcast_name, episodes: [...] }
```

**ç»„ä»¶ç»“æ„**:
```
PodcastDetailPage
â”œâ”€â”€ PodcastInfoCardï¼ˆæ’­å®¢ä¿¡æ¯ï¼‰
â””â”€â”€ EpisodeListï¼ˆèŠ‚ç›®æ¸…å•ï¼‰
    â””â”€â”€ EpisodeListItem Ã— 5
```

---

### 3. EpisodeTabPageï¼ˆTab åŠŸèƒ½é¡µï¼‰
**è·¯ç”±**: `/episode/:id`
**ç”¨é€”**: æ˜¾ç¤ºå•é›†çš„å®Œæ•´åŠŸèƒ½ï¼ˆTab å¯¼èˆªï¼‰

**åŠŸèƒ½**:
- å·¦ä¾§ Tab å¯¼èˆªï¼ˆ224px å›ºå®šå®½åº¦ï¼‰
- å³ä¾§å†…å®¹åŒº
- å››ä¸ª Tabï¼šOverviewã€TRANSCRIPTã€CHAPTERSã€NOTE

**URL å‚æ•°**:
```typescript
{
  id: string  // å•é›† ID
}
```

**æ•°æ®æ¥æº**:
```typescript
// 1. æ£€æŸ¥ LocalStorage
const episodeData = localStorage.getItem(`episode_${id}`);

// 2. å¦‚æœä¸å­˜åœ¨ï¼Œè°ƒç”¨ API
if (!episodeData) {
  GET /api/crawler/parse
  Request: { url: "https://www.xiaoyuzhoufm.com/episode/xxx" }
}
```

**ç»„ä»¶ç»“æ„**:
```
EpisodeTabPage
â”œâ”€â”€ TabNavigationï¼ˆå·¦ä¾§å¯¼èˆªï¼‰
â”‚   â”œâ”€â”€ OverviewTab
â”‚   â”œâ”€â”€ TranscriptTab
â”‚   â”œâ”€â”€ ChaptersTab
â”‚   â””â”€â”€ NoteTab
â””â”€â”€ ContentAreaï¼ˆå³ä¾§å†…å®¹ï¼‰
    â”œâ”€â”€ AudioPlayer
    â””â”€â”€ TabContentï¼ˆæ ¹æ® activeTab æ¸²æŸ“ï¼‰
```

**æœªå¤„ç†å•é›†å¤„ç†**:
```
æ£€æŸ¥ LocalStorage
  â†“
ä¸å­˜åœ¨ â†’ æ˜¾ç¤ºæ‚¬æµ®æŒ‰é’®"Run AI Processing"ï¼ˆåŒºåŸŸä¸­å¤®ï¼‰
  â†“
ç”¨æˆ·ç‚¹å‡» â†’ è°ƒç”¨è½¬å½• API â†’ æ˜¾ç¤ºè¿›åº¦
  â†“
å®Œæˆ â†’ ä¿å­˜åˆ° LocalStorage â†’ éšè—æŒ‰é’®
```

---

### 4. SearchPageï¼ˆæœç´¢é¡µï¼‰- è®¡åˆ’ä¸­
**è·¯ç”±**: `/search?keyword=xxx&entity=all`
**ç”¨é€”**: æœç´¢æ’­å®¢å’Œå•é›†

**åŠŸèƒ½**:
- æœç´¢æ¡†
- Podcasts ç»“æœåˆ—è¡¨
- Episodes ç»“æœåˆ—è¡¨
- ç‚¹å‡»è·³è½¬åˆ°å¯¹åº”é¡µé¢

**URL å‚æ•°**:
```typescript
{
  keyword: string,  // æœç´¢å…³é”®è¯
  entity: 'all' | 'podcast' | 'episode'  // æœç´¢ç±»å‹
}
```

---

## ğŸ”€ è·¯ç”±è·³è½¬ç¤ºä¾‹

### åœºæ™¯ 1ï¼šç”¨æˆ·è¾“å…¥å•é›†é“¾æ¥
```typescript
// InputPage.tsx
const handleSingleEpisodeLink = (url: string) => {
  const episodeId = extractEpisodeId(url);  // ä» URL æå– ID
  navigate(`/episode/${episodeId}`);
};
```

### åœºæ™¯ 2ï¼šç”¨æˆ·è¾“å…¥æ’­å®¢ä¸»é¡µé“¾æ¥
```typescript
// InputPage.tsx
const handlePodcastLink = (url: string) => {
  const podcastId = extractPodcastId(url);  // ä» URL æå– ID
  navigate(`/podcast/${podcastId}`);
};
```

### åœºæ™¯ 3ï¼šä»æ’­å®¢è¯¦æƒ…é¡µç‚¹å‡»å•é›†
```typescript
// PodcastDetailPage.tsx
const handleEpisodeClick = (episodeId: string) => {
  navigate(`/episode/${episodeId}`);
};
```

---

## ğŸ› ï¸ æŠ€æœ¯å®ç°

### å®‰è£… React Router
```bash
npm install react-router-dom
```

### è·¯ç”±é…ç½®
```tsx
// App.tsx
import { BrowserRouter, Routes, Route } from 'react-router-dom';

function App() {
  return (
    <BrowserRouter>
      <Routes>
        <Route path="/" element={<InputPage />} />
        <Route path="/podcast/:id" element={<PodcastDetailPage />} />
        <Route path="/episode/:id" element={<EpisodeTabPage />} />
      </Routes>
    </BrowserRouter>
  );
}
```

### è·¯ç”±å‚æ•°è·å–
```tsx
// PodcastDetailPage.tsx
import { useParams } from 'react-router-dom';

function PodcastDetailPage() {
  const { id } = useParams<{ id: string }>();

  useEffect(() => {
    // ä½¿ç”¨ id è·å–æ•°æ®
    fetchPodcastData(id);
  }, [id]);

  return <div>...</div>;
}
```

### ç¼–ç¨‹å¼å¯¼èˆª
```tsx
import { useNavigate } from 'react-router-dom';

function MyComponent() {
  const navigate = useNavigate();

  const handleClick = () => {
    navigate('/podcast/xxx');
  };

  return <button onClick={handleClick}>Go</button>;
}
```

---

## ğŸ“Š è·¯ç”±å¯¹æ¯”ï¼ˆScripod vs Bookshelf Soundsï¼‰

| åŠŸèƒ½ | Scripod | Bookshelf Sounds |
|------|---------|------------------|
| æœç´¢é¡µ | `/search?keyword=...` | `/search?keyword=...` âœ… |
| æ’­å®¢è¯¦æƒ… | `/channel/:id` | `/podcast/:id` âœ… |
| å•é›†è¯¦æƒ… | `/episode/:id` | `/episode/:id` âœ… |
| è·¯ç”±æŠ€æœ¯ | React Router | React Router âœ… |

---

## âœ… éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½å®Œæ•´æ€§
- âœ… æ‰€æœ‰è·¯ç”±æ­£å¸¸å·¥ä½œ
- âœ… URL å‚æ•°æ­£ç¡®ä¼ é€’
- âœ… æµè§ˆå™¨å‰è¿›/åé€€æ­£å¸¸
- âœ… åˆ·æ–°é¡µé¢ä¸ä¸¢å¤±æ•°æ®

### æ€§èƒ½ä¼˜åŒ–
- âœ… Lazy Loading æ­£ç¡®å®ç°
- âœ… ä»£ç åˆ†å‰²ç”Ÿæ•ˆ
- âœ… é¦–å±åŠ è½½ < 2s
- âœ… è·¯ç”±åˆ‡æ¢ < 100ms

### ç”¨æˆ·ä½“éªŒ
- âœ… URL å¯è¯»æ€§å¼º
- âœ… æ”¯æŒç›´æ¥åˆ†äº« URL
- âœ… 404 é¡µé¢å‹å¥½æç¤º
- âœ… Loading çŠ¶æ€æµç•…

---

## ğŸ”® æœªæ¥è§„åˆ’

### çŸ­æœŸï¼ˆv2.1.0ï¼‰
- [ ] å®ç° React Router åŸºç¡€è·¯ç”±
- [ ] ä¸‰ä¸ªé¡µé¢æ­£å¸¸å·¥ä½œ
- [ ] URL å‚æ•°ä¼ é€’æ­£ç¡®

### ä¸­æœŸï¼ˆv2.2.0ï¼‰
- [ ] æ·»åŠ æœç´¢é¡µè·¯ç”±
- [ ] å®ç° Lazy Loading
- [ ] ä¼˜åŒ–è·¯ç”±åˆ‡æ¢åŠ¨ç”»

### é•¿æœŸï¼ˆv3.0.0ï¼‰
- [ ] æ·»åŠ  404 é¡µé¢
- [ ] æ”¯æŒæµè§ˆå™¨å›é€€ç¼“å­˜
- [ ] å®ç°è·¯ç”±çº§åˆ«çš„æƒé™æ§åˆ¶

---

**æœ€åæ›´æ–°**: 2026-01-29
**ç»´æŠ¤è€…**: Claude Code
**ç‰ˆæœ¬**: v2.1.0
