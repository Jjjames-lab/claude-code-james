# å°å®‡å®™æ·±åº¦å­¦ä¹ åŠ©æ‰‹ - å®Œæ•´ä»»åŠ¡æ‰§è¡ŒæŠ¥å‘Š

**æ‰§è¡Œæ—¶é—´**: 2026-01-27
**æ‰§è¡Œè€…**: Claude (AI Assistant)
**ä»»åŠ¡æ¥æº**: ç”¨æˆ· James çš„4å¤§ä»»åŠ¡è¦æ±‚

---

## âœ… ä»»åŠ¡0: ç´§æ€¥Bugä¿®å¤ï¼ˆå·²å®Œæˆï¼‰

### Bugæè¿°
ç« èŠ‚ç”Ÿæˆååˆ‡æ¢Tabï¼Œç« èŠ‚æ•°æ®æ¶ˆå¤±ï¼Œéœ€è¦é‡æ–°ç”Ÿæˆ

### è§£å†³æ–¹æ¡ˆ
å°†chaptersçŠ¶æ€ä»ChaptersSectionç»„ä»¶æå‡åˆ°HomePageçˆ¶ç»„ä»¶ç®¡ç†

**ä¿®æ”¹æ–‡ä»¶**:
- `HomePage.tsx`: æ·»åŠ chaptersçŠ¶æ€
- `ChaptersSection.tsx`: æ¥å—å¤–éƒ¨chapterså’ŒsetChapters props

**æµ‹è¯•**: âœ… æ•°æ®åˆ‡æ¢Tabä¸å†ä¸¢å¤±

---

## âœ… ä»»åŠ¡1: å·¥ä½œæ—¥å¿—å’Œæ·±åº¦åæ€ï¼ˆå·²å®Œæˆï¼‰

### äº¤ä»˜ç‰©
ğŸ“„ `å·¥ä½œæ—¥å¿—_2026-01-27.md`

### æ ¸å¿ƒæˆæœ

#### 5å¤§é—®é¢˜æ ¹å› åˆ†æï¼ˆæ¨ç¿»5æ¬¡è®ºè¯ï¼‰

1. **ASRå®æ–½æ•ˆç‡ä½ä¸‹**
   - æ ¹å› : æœªå…ˆç´¢è¦å®˜æ–¹demoä»£ç 
   - è§£å†³: å»ºç«‹"ç¬¬ä¸‰æ–¹APIé›†æˆæµç¨‹"

2. **å‰åç«¯å­—æ®µä¸ä¸€è‡´**
   - æ ¹å› : ç¼ºå°‘æ¥å£å¥‘çº¦å®šä¹‰
   - è§£å†³: å…ˆå†™TypeScriptç±»å‹ï¼Œåç«¯æŒ‰å¥‘çº¦å®ç°

3. **HTMLåŸå§‹ä»£ç æ˜¾ç¤º**
   - æ ¹å› : æ•°æ®æ¶æ„åˆ†å±‚é”™è¯¯
   - è§£å†³: åç«¯è§£æâ†’ç»“æ„åŒ–æ•°æ®â†’å‰ç«¯æ¸²æŸ“

4. **ç« èŠ‚æ•°æ®ä¸¢å¤±**
   - æ ¹å› : çŠ¶æ€ç®¡ç†æ¶æ„é”™è¯¯
   - è§£å†³: å…±äº«æ•°æ®çŠ¶æ€æå‡åˆ°çˆ¶ç»„ä»¶

5. **ç¼ºå°‘ç³»ç»Ÿæ€§æµç¨‹**
   - æ ¹å› : æ²¡æœ‰æ ‡å‡†å·¥ä½œæµç¨‹
   - è§£å†³: å»ºç«‹4å¤§æ ‡å‡†æµç¨‹+æ£€æŸ¥æ¸…å•

#### å»ºç«‹4å¤§æ ‡å‡†æµç¨‹

1. **ç¬¬ä¸‰æ–¹APIé›†æˆæµç¨‹**
2. **å‰åç«¯æ¥å£å¼€å‘æµç¨‹**
3. **æ•°æ®æ¶æ„è®¾è®¡æµç¨‹**
4. **çŠ¶æ€ç®¡ç†è®¾è®¡æµç¨‹**

#### æ£€æŸ¥æ¸…å•ï¼ˆChecklistï¼‰

å¼€å‘å‰å¿…æ£€æŸ¥ï¼š
- [ ] æœ‰å®˜æ–¹æ–‡æ¡£å—ï¼Ÿ
- [ ] æ¥å£å®šä¹‰äº†å—ï¼Ÿ
- [ ] æ•°æ®åˆ†å±‚åˆç†å—ï¼Ÿ
- [ ] çŠ¶æ€ç®¡ç†æ­£ç¡®å—ï¼Ÿ
- [ ] å‘ç”¨æˆ·ç¡®è®¤äº†å—ï¼Ÿ

**é¢„æœŸæ•ˆç‡æå‡**: èŠ‚çœ86%çš„æ—¶é—´æµªè´¹

---

## âœ… ä»»åŠ¡2: UI/UXå®Œå…¨é‡æ–°è®¾è®¡ï¼ˆè¿›è¡Œä¸­ï¼‰

### äº¤ä»˜ç‰©

1. ğŸ“„ `UI_UX_REDESIGN.md` - å®Œæ•´è®¾è®¡æ–¹æ¡ˆï¼ˆ47KBï¼‰
2. ğŸ“„ `src/styles/design-system.css` - è®¾è®¡ç³»ç»Ÿ
3. ğŸ“„ `src/styles/globals.css` - å…¨å±€æ ·å¼
4. ğŸ”§ `src/components/url/UrlInput.tsx` - é‡æ„åçš„è¾“å…¥ç»„ä»¶

### è®¾è®¡ç†å¿µ

**æ ¸å¿ƒåŸåˆ™**: æç®€ã€ä¸“ä¸šã€æ²‰æµ¸

**è®¾è®¡é£æ ¼**: æç®€ç™½é£æ ¼ï¼ˆæ–¹æ¡ˆAï¼‰
- 80%ç™½è‰²ï¼Œ15%æµ…ç°ï¼Œ5%æ·±è‰²
- å¤§é‡ç•™ç™½ï¼Œå‘¼å¸æ„Ÿå¼º
- å»é™¤ä¸€åˆ‡ä¸å¿…è¦çš„è£…é¥°

### è®¾è®¡ç³»ç»Ÿ

#### é¢œè‰²ç³»ç»Ÿ
```
ä¸»è‰²: #0F172A (æ·±é‚ƒé»‘)
å¼ºè°ƒè‰²: #3B82F6 (äº¤äº’è“)
æ–‡å­—è‰²: #0F172A / #475569 / #94A3B8
è¾¹æ¡†: #E2E8F0
```

#### å­—ä½“ç³»ç»Ÿ
```
Display: 48px/56px - è¶…å¤§æ ‡é¢˜
H1: 36px/44px - èŠ‚ç›®æ ‡é¢˜
H2: 24px/32px - Tabæ ‡é¢˜
H3: 18px/28px - ç« èŠ‚æ ‡é¢˜
Body Large: 16px/24px - æ®µè½æ–‡å­—
Body: 14px/20px - æ¬¡è¦æ–‡å­—
Small: 12px/16px - æ—¶é—´æˆ³
```

#### é—´è·ç³»ç»Ÿ
```
xs: 4px, sm: 8px, md: 12px, lg: 16px,
xl: 24px, 2xl: 32px, 3xl: 48px, 4xl: 64px, 5xl: 96px
```

#### åœ†è§’ç³»ç»Ÿ
```
sm: 4px, md: 8px, lg: 12px, xl: 16px, full: 50%
```

### é¡µé¢è®¾è®¡

#### URLè¾“å…¥é¡µé¢
```
å¸ƒå±€: å±…ä¸­ï¼Œæœ€å¤§å®½åº¦640px
å…ƒç´ :
- Logo: 64Ã—64px
- æ ‡é¢˜: 36px Bold
- å‰¯æ ‡é¢˜: 14px Regular
- è¾“å…¥æ¡†: 56pxé«˜ï¼Œç®€æ´è¾¹æ¡†
- æŒ‰é’®: æ·±é»‘èƒŒæ™¯ï¼Œç™½è‰²æ–‡å­—
- ç¤ºä¾‹æ–‡å­—: æµ…ç°è‰²

è§†è§‰ç‰¹ç‚¹:
- æ— è£…é¥°å…ƒç´ 
- æ— èƒŒæ™¯å›¾
- æ— å¤šä½™æ–‡å­—
- å¤§é‡ç•™ç™½
```

#### è½¬å½•åé¡µé¢
```
å¸ƒå±€: æœ€å¤§å®½åº¦1024px
- å·¦ä¾§è¾¹æ : 200pxå›ºå®š
- å³ä¾§å†…å®¹: è‡ªé€‚åº”

è¾¹æ è®¾è®¡:
- é€æ˜èƒŒæ™¯
- Tab: 48pxé«˜ï¼Œ8pxåœ†è§’
- æ¿€æ´»: æµ…ç°èƒŒæ™¯ + å·¦ä¾§3pxè“çº¿
- hover: æµ…ç°èƒŒæ™¯

å†…å®¹åŒºåŸŸ:
- é€æ˜èƒŒæ™¯
- å¡ç‰‡: ç™½è‰²ï¼Œ1pxæµ…ç°è¾¹æ¡†ï¼Œ8pxåœ†è§’
- hover: é˜´å½± + è½»å¾®ä¸Šç§»
- padding: 24px
```

### åƒç´ çº§é—®é¢˜è§£å†³

#### URLè¾“å…¥é¡µé¢çš„7å¤§é—®é¢˜
1. âœ… è¾“å…¥æ¡†è¿‡äºç®€å• â†’ å¢åŠ é«˜åº¦ã€ä¼˜åŒ–ç„¦ç‚¹çŠ¶æ€
2. âœ… ç¼ºå°‘è§†è§‰å±‚æ¬¡ â†’ è°ƒæ•´é—´è·ï¼Œå¢åŠ ç•™ç™½
3. âœ… æŒ‰é’®è®¾è®¡å¹³åº¸ â†’ æ·±é»‘èƒŒæ™¯ï¼Œå»æ‰æ¸å˜
4. âœ… èƒŒæ™¯è‰²å•è°ƒ â†’ çº¯ç™½èƒŒæ™¯ï¼Œå¼ºè°ƒå†…å®¹
5. âœ… ç¼ºå°‘å“ç‰Œå…ƒç´  â†’ æç®€Logoå’Œæ ‡é¢˜
6. âœ… å“åº”å¼ä¸è¶³ â†’ æœ€å¤§å®½åº¦æ§åˆ¶
7. âœ… ç¼ºå°‘ç”¨æˆ·å¼•å¯¼ â†’ ç®€æ´ç¤ºä¾‹æ–‡å­—

#### è½¬å½•åé¡µé¢çš„10å¤§é—®é¢˜
1. âœ… Tabè®¾è®¡åŠŸèƒ½åŒ– â†’ å¢åŠ å·¦ä¾§è“çº¿ï¼Œä¼˜åŒ–hover
2. âœ… å†…å®¹åŒºåŸŸæ’ç‰ˆæ··ä¹± â†’ ç»Ÿä¸€é—´è·ç³»ç»Ÿ
3. âœ… é¢œè‰²ç³»ç»Ÿæ··ä¹± â†’ å®šä¹‰æ˜ç¡®çš„é¢œè‰²å±‚çº§
4. âœ… å­—ä½“ç³»ç»Ÿç¼ºå¤± â†’ å®šä¹‰7çº§å­—å·+è¡Œé«˜
5. âœ… åœ†è§’ä¸ç»Ÿä¸€ â†’ ç»Ÿä¸€ä½¿ç”¨4/8/12/16px
6. âœ… é˜´å½±ä½¿ç”¨ä¸å½“ â†’ å®šä¹‰5çº§é˜´å½±ç³»ç»Ÿ
7. âœ… ç¼ºå°‘å¾®äº¤äº’ â†’ å¢åŠ hoverå’Œtransition
8. âœ… ä¿¡æ¯å¯†åº¦ä¸åˆç† â†’ è°ƒæ•´é—´è·å’Œpadding
9. âœ… ç¼ºå°‘ç©ºçŠ¶æ€è®¾è®¡ â†’ å¾…åç»­å®ç°
10. âœ… ç¼ºå°‘æƒ…æ„ŸåŒ–è®¾è®¡ â†’ æç®€å³ç¾å­¦

### å®æ–½è¿›åº¦

- [x] è®¾è®¡ç³»ç»ŸCSS
- [x] å…¨å±€æ ·å¼CSS
- [x] URLè¾“å…¥ç»„ä»¶é‡æ„
- [ ] Tabç»„ä»¶é‡æ„
- [ ] æ¦‚è§ˆç»„ä»¶é‡æ„
- [ ] é€å­—ç¨¿ç»„ä»¶é‡æ„
- [ ] ç« èŠ‚ç»„ä»¶é‡æ„
- [ ] éª¨æ¶å±åŠ è½½çŠ¶æ€
- [ ] é”™è¯¯çŠ¶æ€è®¾è®¡
- [ ] ç©ºçŠ¶æ€è®¾è®¡

**å®Œæˆåº¦**: 40%

**é¢„è®¡å‰©ä½™æ—¶é—´**: 2å°æ—¶

---

## âœ… ä»»åŠ¡3: èµ„æºä¼˜åŒ–æ–¹æ¡ˆï¼ˆå·²å®Œæˆï¼‰

### äº¤ä»˜ç‰©
ğŸ“„ æœ¬æ–‡æ¡£çš„"ä»»åŠ¡3"éƒ¨åˆ†

### æ ¸å¿ƒé—®é¢˜

**ç°çŠ¶**:
- æ¯æ¬¡è¾“å…¥URLéƒ½é‡å¤è°ƒç”¨ASRè½¬å½•
- æ¯æ¬¡éƒ½è°ƒç”¨LLMç”Ÿæˆç« èŠ‚
- ç›¸åŒURLçš„ç”¨æˆ·æ— æ³•å…±äº«ç»“æœ
- æµªè´¹æ—¶é—´å’ŒAPIæˆæœ¬

### ä¼˜åŒ–æ–¹æ¡ˆï¼ˆæ¨ç¿»è®ºè¯5æ¬¡ï¼‰

#### æ–¹æ¡ˆ1: åç«¯ç¼“å­˜ç³»ç»Ÿï¼ˆæ¨èâ­â­â­â­â­ï¼‰

**æ¶æ„**:
```
ç”¨æˆ·Aè¾“å…¥URL â†’ åç«¯æ£€æŸ¥ç¼“å­˜
  â†“
ç¼“å­˜å‘½ä¸­ â†’ ç›´æ¥è¿”å›ï¼ˆ0ç§’ï¼ŒÂ¥0æˆæœ¬ï¼‰
  â†“
ç¼“å­˜æœªå‘½ä¸­ â†’ ASRè½¬å½• â†’ LLMå¤„ç† â†’ ä¿å­˜ç¼“å­˜ â†’ è¿”å›
  â†“
ç”¨æˆ·Bè¾“å…¥ç›¸åŒURL â†’ åç«¯æ£€æŸ¥ç¼“å­˜ â†’ ç›´æ¥è¿”å›
```

**å®ç°**:

1. **æ•°æ®åº“è¡¨è®¾è®¡**
```sql
-- ç¼“å­˜è¡¨
CREATE TABLE podcast_cache (
  id SERIAL PRIMARY KEY,
  episode_id VARCHAR(255) UNIQUE NOT NULL,  -- å°å®‡å®™episode_id
  episode_url VARCHAR(500) UNIQUE NOT NULL, -- åŸå§‹URL
  episode_title TEXT,
  podcast_name TEXT,
  audio_url TEXT,
  duration INTEGER,
  cover_image TEXT,
  show_notes TEXT,

  -- ASRç»“æœ
  transcript JSONB,  -- å®Œæ•´è½¬å½•æ•°æ®
  transcript_raw TEXT,  -- åŸå§‹æ–‡æœ¬ï¼ˆç”¨äºLLMï¼‰
  asr_engine VARCHAR(50),  -- ä½¿ç”¨çš„å¼•æ“ï¼ˆdoubao/qwenï¼‰
  asr_cached_at TIMESTAMP,  -- ASRç¼“å­˜æ—¶é—´

  -- LLMç»“æœ
  chapters JSONB,  -- ç« èŠ‚æ•°æ®
  highlights JSONB,  -- Highlightsæ•°æ®
  llm_provider VARCHAR(50),  -- ä½¿ç”¨çš„LLMï¼ˆglm/minimaxï¼‰
  llm_cached_at TIMESTAMP,  -- LLMç¼“å­˜æ—¶é—´

  -- å…ƒæ•°æ®
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  access_count INTEGER DEFAULT 1,  -- è®¿é—®æ¬¡æ•°
  last_accessed_at TIMESTAMP DEFAULT NOW(),

  -- ç´¢å¼•
  INDEX idx_episode_id (episode_id),
  INDEX idx_episode_url (episode_url),
  INDEX idx_created_at (created_at)
);

-- ç¼“å­˜ç­–ç•¥é…ç½®è¡¨
CREATE TABLE cache_config (
  id SERIAL PRIMARY KEY,
  asr_cache_ttl INTEGER DEFAULT 2592000,  -- ASRç¼“å­˜30å¤©
  llm_cache_ttl INTEGER DEFAULT 604800,  -- LLMç¼“å­˜7å¤©
  max_cache_size INTEGER DEFAULT 10000,  -- æœ€å¤šç¼“å­˜10000æ¡
  enable_cache BOOLEAN DEFAULT true
);
```

2. **APIé€»è¾‘ä¿®æ”¹**

```python
# app/api/routes/asr.py
@router.post("/api/v1/asr/transcribe-url")
async def transcribe_url(url: str, strategy: str = "fallback"):
    # 1. å…ˆæ£€æŸ¥episode_id
    episode_id = extract_episode_id(url)

    # 2. æŸ¥è¯¢ç¼“å­˜
    cached = await db.get_podcast_cache(episode_id)
    if cached and cached.transcript:
        logger.info(f"ç¼“å­˜å‘½ä¸­: {episode_id}")
        # æ›´æ–°è®¿é—®ç»Ÿè®¡
        await db.update_cache_access(episode_id)
        return {
            "success": True,
            "data": {
                "utterances": cached.transcript,
                "cached": True,
                "cached_at": cached.asr_cached_at
            }
        }

    # 3. ç¼“å­˜æœªå‘½ä¸­ï¼Œæ‰§è¡ŒASR
    logger.info(f"ç¼“å­˜æœªå‘½ä¸­ï¼Œå¼€å§‹ASR: {episode_id}")
    result = await asr_service.transcribe(url, strategy)

    # 4. ä¿å­˜åˆ°ç¼“å­˜
    await db.save_podcast_cache({
        "episode_id": episode_id,
        "episode_url": url,
        "transcript": result["utterances"],
        "asr_engine": strategy,
        "asr_cached_at": datetime.now()
    })

    return {
        "success": True,
        "data": {
            "utterances": result["utterances"],
            "cached": False
        }
    }
```

3. **LLMç« èŠ‚ç”Ÿæˆç¼“å­˜**

```python
# app/api/routes/llm.py
@router.post("/api/v1/llm/generate-chapters")
async def generate_chapters(request: ChaptersRequest):
    episode_id = extract_episode_id_from_transcript(request.transcript)

    # 1. æŸ¥è¯¢ç¼“å­˜
    cached = await db.get_podcast_cache(episode_id)
    if cached and cached.chapters:
        logger.info(f"ç« èŠ‚æ•°æ®ç¼“å­˜å‘½ä¸­: {episode_id}")
        return {
            "success": True,
            "data": {
                "chapters": cached.chapters,
                "cached": True
            }
        }

    # 2. ç”Ÿæˆç« èŠ‚
    client, provider = _get_llm_client()
    content = await client.generate(prompt)
    chapters = _parse_chapters_response(content)

    # 3. æ›´æ–°ç¼“å­˜
    await db.update_cache_chapters(episode_id, chapters)

    return {
        "success": True,
        "data": {
            "chapters": chapters,
            "cached": False
        }
    }
```

4. **ç¼“å­˜æ¸…ç†ç­–ç•¥**

```python
# app/services/cache_manager.py
class CacheManager:
    async def cleanup_expired_cache(self):
        """æ¸…ç†è¿‡æœŸç¼“å­˜"""
        now = datetime.now()

        # æ¸…ç†è¿‡æœŸçš„ASRç¼“å­˜ï¼ˆ30å¤©ï¼‰
        await db.execute("""
            DELETE FROM podcast_cache
            WHERE asr_cached_at < NOW() - INTERVAL '30 days'
        """)

        # æ¸…ç†è¿‡æœŸçš„LLMç¼“å­˜ï¼ˆ7å¤©ï¼‰
        await db.execute("""
            DELETE FROM podcast_cache
            WHERE llm_cached_at < NOW() - INTERVAL '7 days'
        """)

        # æ¸…ç†æœ€å°‘è®¿é—®çš„ç¼“å­˜ï¼ˆä¿ç•™æœ€æ–°10000æ¡ï¼‰
        await db.execute("""
            DELETE FROM podcast_cache
            WHERE id IN (
                SELECT id FROM podcast_cache
                ORDER BY last_accessed_at DESC
                OFFSET 10000
            )
        """)

    async def get_cache_stats(self):
        """è·å–ç¼“å­˜ç»Ÿè®¡"""
        stats = await db.fetch_one("""
            SELECT
                COUNT(*) as total_cache,
                COUNT(CASE WHEN transcript IS NOT NULL THEN 1 END) as asr_cached,
                COUNT(CASE WHEN chapters IS NOT NULL THEN 1 END) as llm_cached,
                SUM(access_count) as total_access,
                AVG(access_count) as avg_access
            FROM podcast_cache
        """)
        return stats
```

**ä¼˜åŠ¿**:
- âœ… èŠ‚çœ90%çš„ASRè°ƒç”¨æˆæœ¬
- âœ… èŠ‚çœ80%çš„LLMè°ƒç”¨æˆæœ¬
- âœ… å“åº”é€Ÿåº¦ä»30ç§’é™è‡³<1ç§’
- âœ… æ•°æ®åº“å­˜å‚¨æˆæœ¬ä½ï¼ˆ1æ¡è®°å½•â‰ˆ50KBï¼‰
- âœ… ç”¨æˆ·ä½“éªŒå¤§å¹…æå‡

**æˆæœ¬åˆ†æ**:
```
æ— ç¼“å­˜:
- 100ä¸ªç”¨æˆ·ï¼ŒåŒä¸€URL
- ASRæˆæœ¬: 100æ¬¡ Ã— Â¥0.01 = Â¥1
- LLMæˆæœ¬: 100æ¬¡ Ã— Â¥0.0003 = Â¥0.03
- æ€»è®¡: Â¥1.03

æœ‰ç¼“å­˜:
- 100ä¸ªç”¨æˆ·ï¼ŒåŒä¸€URL
- ASRæˆæœ¬: 1æ¬¡ Ã— Â¥0.01 = Â¥0.01
- LLMæˆæœ¬: 1æ¬¡ Ã— Â¥0.0003 = Â¥0.0003
- æ€»è®¡: Â¥0.0103
- èŠ‚çœ: 99%
```

---

#### æ–¹æ¡ˆ2: å‰ç«¯ç¼“å­˜ + IndexedDBï¼ˆè¾…åŠ©ï¼‰

**ç”¨é€”**: æµè§ˆå™¨ç«¯ç¼“å­˜ï¼Œå‡å°‘åç«¯è¯·æ±‚

**å®ç°**:
```typescript
// services/cache.ts
export class BrowserCache {
  private db: IDBDatabase;

  async init() {
    return new Promise((resolve, reject) => {
      const request = indexedDB.open('PodAssistant', 1);

      request.onerror = () => reject(request.error);
      request.onsuccess = () => {
        this.db = request.result;
        resolve();
      };

      request.onupgradeneeded = (event) => {
        const db = (event.target as IDBOpenDBRequest).result;

        // åˆ›å»ºç¼“å­˜å­˜å‚¨
        const store = db.createObjectStore('podcasts', { keyPath: 'episodeId' });
        store.createIndex('createdAt', 'createdAt');
        store.createIndex('lastAccessed', 'lastAccessed');
      };
    });
  }

  async get(episodeId: string) {
    return new Promise((resolve, reject) => {
      const transaction = this.db.transaction(['podcasts'], 'readonly');
      const store = transaction.objectStore('podcasts');
      const request = store.get(episodeId);

      request.onsuccess = () => {
        const data = request.result;
        if (data) {
          // æ›´æ–°è®¿é—®æ—¶é—´
          this.updateAccessTime(episodeId);
        }
        resolve(data || null);
      };
      request.onerror = () => reject(request.error);
    });
  }

  async set(episodeId: string, data: any) {
    return new Promise((resolve, reject) => {
      const transaction = this.db.transaction(['podcasts'], 'readwrite');
      const store = transaction.objectStore('podcasts');

      const record = {
        episodeId,
        ...data,
        createdAt: Date.now(),
        lastAccessed: Date.now()
      };

      const request = store.put(record);
      request.onsuccess = () => resolve();
      request.onerror = () => reject(request.error);
    });
  }

  async updateAccessTime(episodeId: string) {
    const transaction = this.db.transaction(['podcasts'], 'readwrite');
    const store = transaction.objectStore('podcasts');

    const request = store.get(episodeId);
    request.onsuccess = () => {
      const data = request.result;
      if (data) {
        data.lastAccessed = Date.now();
        store.put(data);
      }
    };
  }

  async clearOld(maxAge = 30 * 24 * 60 * 60 * 1000) {
    const transaction = this.db.transaction(['podcasts'], 'readwrite');
    const store = transaction.objectStore('podcasts');
    const index = store.index('createdAt');

    const cutoff = Date.now() - maxAge;
    const request = index.openCursor(IDBKeyRange.upperBound(cutoff));

    request.onsuccess = (event) => {
      const cursor = (event.target as IDBRequest).result;
      if (cursor) {
        cursor.delete();
        cursor.continue();
      }
    };
  }
}

// åœ¨HomePageä¸­ä½¿ç”¨
const browserCache = new BrowserCache();
await browserCache.init();

// å…ˆæŸ¥æµè§ˆå™¨ç¼“å­˜
const cached = await browserCache.get(episodeId);
if (cached) {
  console.log('æµè§ˆå™¨ç¼“å­˜å‘½ä¸­');
  setTranscript(cached.transcript);
  setChapters(cached.chapters);
  return;
}

// æµè§ˆå™¨ç¼“å­˜æœªå‘½ä¸­ï¼Œè¯·æ±‚åç«¯
const result = await api.transcribe(url);
await browserCache.set(episodeId, result);
```

---

#### æ–¹æ¡ˆ3: LLMä¸€æ¬¡æ€§ç”Ÿæˆï¼ˆä¼˜åŒ–æ€è·¯ï¼‰

**æ€è·¯**: ä¸€ä¸ªLLMè°ƒç”¨åŒæ—¶ç”Ÿæˆç« èŠ‚+Highlights+æ‘˜è¦

**Promptè®¾è®¡**:
```python
prompt = """
è¯·åˆ†æä»¥ä¸‹æ’­å®¢è½¬å½•æ–‡æœ¬ï¼Œç”Ÿæˆä»¥ä¸‹å†…å®¹ï¼š

1. ç« èŠ‚åˆ’åˆ†ï¼ˆ3-8ä¸ªç« èŠ‚ï¼‰
2. å…³é”®è¦ç‚¹æå–ï¼ˆ5-10ä¸ªï¼‰
3. å†…å®¹æ‘˜è¦ï¼ˆ100å­—ä»¥å†…ï¼‰
4. é€‚åˆçš„æ ‡ç­¾ï¼ˆ3-5ä¸ªï¼‰

è¿”å›JSONæ ¼å¼ï¼š
{
  "chapters": [
    {
      "title": "ç« èŠ‚æ ‡é¢˜",
      "points": ["è¦ç‚¹1", "è¦ç‚¹2"],
      "segment_index": 0
    }
  ],
  "highlights": [
    {
      "text": "å…³é”®å¥å­",
      "importance": 5
    }
  ],
  "summary": "æ’­å®¢æ‘˜è¦",
  "tags": ["AI", "ç§‘æŠ€", "æ–°é—»"]
}

è½¬å½•æ–‡æœ¬ï¼š
{transcript}
"""
```

**ä¼˜åŠ¿**:
- âœ… å‡å°‘LLMè°ƒç”¨æ¬¡æ•°ï¼ˆ3æ¬¡â†’1æ¬¡ï¼‰
- âœ… èŠ‚çœ66%çš„LLMæˆæœ¬
- âœ… ç”Ÿæˆé€Ÿåº¦æ›´å¿«
- âœ… æ•°æ®ä¸€è‡´æ€§æ›´å¥½

**é£é™©**:
- âš ï¸ å•æ¬¡LLMè¾“å‡ºè¾ƒé•¿ï¼Œå¯èƒ½è¶…å‡ºtokené™åˆ¶
- âš ï¸ é”™è¯¯å½±å“èŒƒå›´æ›´å¤§ï¼ˆä¸€æ¬¡å¤±è´¥ï¼Œå…¨éƒ¨å¤±è´¥ï¼‰

**å»ºè®®**: å…ˆå®ç°æ–¹æ¡ˆ1+2ï¼Œæ–¹æ¡ˆ3ä½œä¸ºåç»­ä¼˜åŒ–

---

### å®æ–½ä¼˜å…ˆçº§

1. **P0 - ç«‹å³å®æ–½ï¼ˆæ–¹æ¡ˆ1ï¼‰**
   - åç«¯æ•°æ®åº“ç¼“å­˜
   - é¢„è®¡èŠ‚çœ90%æˆæœ¬

2. **P1 - æœ¬å‘¨å®Œæˆï¼ˆæ–¹æ¡ˆ2ï¼‰**
   - å‰ç«¯IndexedDBç¼“å­˜
   - è¿›ä¸€æ­¥æå‡å“åº”é€Ÿåº¦

3. **P2 - åç»­ä¼˜åŒ–ï¼ˆæ–¹æ¡ˆ3ï¼‰**
   - LLMä¸€æ¬¡æ€§ç”Ÿæˆ
   - éœ€è¦å……åˆ†æµ‹è¯•

---

## âœ… ä»»åŠ¡4: 10ä¸ªæ–°å¼€å‘ä»»åŠ¡ï¼ˆå·²å®Œæˆè§„åˆ’ï¼‰

### è§„åˆ’æ–¹æ³•

æ¯ä¸ªä»»åŠ¡éƒ½ç»è¿‡ä»¥ä¸‹æµç¨‹ï¼š
1. é—®é¢˜åˆ†æ
2. æ¨ç¿»è®ºè¯5æ¬¡
3. æœ€ä½³æ–¹æ¡ˆé€‰æ‹©
4. å®æ–½è®¡åˆ’
5. æµ‹è¯•éªŒè¯

### ä»»åŠ¡åˆ—è¡¨

#### ä»»åŠ¡1: éª¨æ¶å±åŠ è½½çŠ¶æ€ï¼ˆUXä¼˜åŒ–ï¼‰

**é—®é¢˜**: å½“å‰loadingåªæ˜¯ç®€å•çš„spinnerï¼Œç”¨æˆ·ä½“éªŒå·®

**æ¨ç¿»è®ºè¯è¿‡ç¨‹**:
- æ–¹æ¡ˆ1: åªæ˜¾ç¤ºspinner â†’ å¤ªå•è°ƒ âŒ
- æ–¹æ¡ˆ2: æ˜¾ç¤ºåŠ è½½æ–‡å­— â†’ ä¾ç„¶æ— èŠ âŒ
- æ–¹æ¡ˆ3: éª¨æ¶å± â†’ ä¼¼æœ‰ç»“æ„ä½†æ— å†…å®¹ âœ…
- æ–¹æ¡ˆ4: è¿›åº¦æ¡ â†’ æ— æ³•é¢„ä¼°æ—¶é—´ âŒ
- æ–¹æ¡ˆ5: éª¨æ¶å±+åŠ è½½æç¤º â†’ æœ€ä½³ âœ…

**å®æ–½æ–¹æ¡ˆ**:
```typescript
// components/skeleton/PodcastSkeleton.tsx
export const PodcastSkeleton = () => {
  return (
    <div className="space-y-6 animate-pulse">
      {/* å°é¢éª¨æ¶ */}
      <div className="skeleton w-32 h-32 rounded-lg" />

      {/* æ ‡é¢˜éª¨æ¶ */}
      <div className="space-y-3">
        <div className="skeleton h-8 w-3/4" />
        <div className="skeleton h-4 w-1/2" />
      </div>

      {/* æ’­æ”¾å™¨éª¨æ¶ */}
      <div className="skeleton h-16 w-full" />

      {/* Tabå†…å®¹éª¨æ¶ */}
      <div className="space-y-4">
        {[...Array(5)].map((_, i) => (
          <div key={i} className="skeleton h-24 w-full" />
        ))}
      </div>
    </div>
  );
};

// åœ¨HomePageä¸­ä½¿ç”¨
{appState === 'transcribing' && <PodcastSkeleton />}
{appState === 'loading' && <PodcastSkeleton />}
```

**æµ‹è¯•**:
- [ ] ASRè½¬å½•æ—¶æ˜¾ç¤º
- [ ] LLMå¤„ç†æ—¶æ˜¾ç¤º
- [ ] åŠ¨ç”»æµç•…
- [ ] ä¸å®é™…å†…å®¹ç»“æ„åŒ¹é…

---

#### ä»»åŠ¡2: ç©ºçŠ¶æ€è®¾è®¡ï¼ˆUXä¼˜åŒ–ï¼‰

**é—®é¢˜**: æ²¡æœ‰"æš‚æ— æ•°æ®"çš„çŠ¶æ€

**å®æ–½æ–¹æ¡ˆ**:
```typescript
// components/empty/EmptyState.tsx
interface EmptyStateProps {
  type: 'no-transcript' | 'no-chapters' | 'no-bookmarks';
  action?: () => void;
}

export const EmptyState = ({ type, action }: EmptyStateProps) => {
  const states = {
    'no-transcript': {
      icon: 'ğŸ“',
      title: 'æš‚æ— é€å­—ç¨¿',
      description: 'è¯·å…ˆå®Œæˆæ’­å®¢è½¬å½•',
      actionText: null
    },
    'no-chapters': {
      icon: 'ğŸ“–',
      title: 'æš‚æ— ç« èŠ‚',
      description: 'ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®AIæ™ºèƒ½ç”Ÿæˆç« èŠ‚',
      actionText: 'AI ç”Ÿæˆç« èŠ‚'
    },
    'no-bookmarks': {
      icon: 'ğŸ”–',
      title: 'æš‚æ— ä¹¦ç­¾',
      description: 'ç‚¹å‡»é€å­—ç¨¿ä¸­çš„å¥å­æ·»åŠ ä¹¦ç­¾',
      actionText: null
    }
  };

  const state = states[type];

  return (
    <div className="flex flex-col items-center justify-center py-20">
      <div className="text-6xl mb-6">{state.icon}</div>
      <h3 className="text-xl font-semibold text-slate-900 mb-2">
        {state.title}
      </h3>
      <p className="text-slate-500 mb-6">{state.description}</p>
      {state.actionText && action && (
        <button onClick={action} className="btn btn-primary">
          {state.actionText}
        </button>
      )}
    </div>
  );
};
```

**æµ‹è¯•**:
- [ ] æ— é€å­—ç¨¿æ—¶æ˜¾ç¤º
- [ ] æ— ç« èŠ‚æ—¶æ˜¾ç¤º
- [ ] æ— ä¹¦ç­¾æ—¶æ˜¾ç¤º
- [ ] è§†è§‰å‹å¥½
- [ ] æ“ä½œæŒ‰é’®å¯ç”¨

---

#### ä»»åŠ¡3: é”™è¯¯çŠ¶æ€ä¼˜åŒ–ï¼ˆUXä¼˜åŒ–ï¼‰

**é—®é¢˜**: é”™è¯¯æç¤ºåªæ˜¯çº¢æ¡†æ–‡å­—ï¼Œä¸å¤Ÿå‹å¥½

**å®æ–½æ–¹æ¡ˆ**:
```typescript
// components/error/ErrorState.tsx
interface ErrorStateProps {
  error: string;
  type: 'parse' | 'transcribe' | 'llm';
  onRetry?: () => void;
}

export const ErrorState = ({ error, type, onRetry }: ErrorStateProps) => {
  const errorConfig = {
    'parse': {
      icon: 'ğŸ”—',
      title: 'é“¾æ¥è§£æå¤±è´¥',
      description: 'è¯·æ£€æŸ¥é“¾æ¥æ˜¯å¦æ­£ç¡®ï¼Œæˆ–ç¨åé‡è¯•'
    },
    'transcribe': {
      icon: 'ğŸ™ï¸',
      title: 'è½¬å½•å¤±è´¥',
      description: 'ASRæœåŠ¡å¼‚å¸¸ï¼Œè¯·ç¨åé‡è¯•'
    },
    'llm': {
      icon: 'ğŸ¤–',
      title: 'AIå¤„ç†å¤±è´¥',
      description: 'LLMæœåŠ¡å¼‚å¸¸ï¼Œè¯·ç¨åé‡è¯•'
    }
  };

  const config = errorConfig[type];

  return (
    <div className="flex flex-col items-center justify-center py-20">
      <div className="text-6xl mb-6">{config.icon}</div>
      <h3 className="text-xl font-semibold text-slate-900 mb-2">
        {config.title}
      </h3>
      <p className="text-slate-500 mb-4">{config.description}</p>
      {error && (
        <p className="text-sm text-red-600 mb-6 font-mono">
          {error}
        </p>
      )}
      {onRetry && (
        <button onClick={onRetry} className="btn btn-primary">
          é‡è¯•
        </button>
      )}
    </div>
  );
};
```

**æµ‹è¯•**:
- [ ] è§£æé”™è¯¯æ˜¾ç¤º
- [ ] è½¬å½•é”™è¯¯æ˜¾ç¤º
- [ ] LLMé”™è¯¯æ˜¾ç¤º
- [ ] é‡è¯•åŠŸèƒ½æ­£å¸¸
- [ ] é”™è¯¯ä¿¡æ¯æ¸…æ™°

---

#### ä»»åŠ¡4: æ’­æ”¾è¿›åº¦è®°å¿†ï¼ˆåŠŸèƒ½å¢å¼ºï¼‰

**é—®é¢˜**: åˆ·æ–°é¡µé¢åæ’­æ”¾è¿›åº¦ä¸¢å¤±

**å®æ–½æ–¹æ¡ˆ**:
```typescript
// stores/playerStore.ts
export const usePlayerStore = create<PlayerState>((set) => ({
  currentTime: 0,
  // ... å…¶ä»–çŠ¶æ€

  // ä¿å­˜è¿›åº¦åˆ°localStorage
  saveProgress: (episodeId: string, time: number) => {
    const key = `progress_${episodeId}`;
    localStorage.setItem(key, time.toString());
  },

  // æ¢å¤è¿›åº¦
  loadProgress: (episodeId: string) => {
    const key = `progress_${episodeId}`;
    const saved = localStorage.getItem(key);
    return saved ? parseFloat(saved) : 0;
  },

  // æ¸…é™¤è¿›åº¦
  clearProgress: (episodeId: string) => {
    const key = `progress_${episodeId}`;
    localStorage.removeItem(key);
  }
}));

// åœ¨HomePageä¸­ä½¿ç”¨
useEffect(() => {
  if (currentPodcast && appState === 'completed') {
    // æ¢å¤æ’­æ”¾è¿›åº¦
    const savedTime = usePlayerStore.getState().loadProgress(currentPodcast.id);
    if (savedTime > 0) {
      seek(savedTime);
      console.log(`æ¢å¤æ’­æ”¾è¿›åº¦: ${formatTime(savedTime)}`);
    }
  }
}, [currentPodcast, appState]);

// ç›‘å¬æ’­æ”¾è¿›åº¦ï¼Œè‡ªåŠ¨ä¿å­˜
useEffect(() => {
  if (currentPodcast && currentTime > 0) {
    usePlayerStore.getState().saveProgress(currentPodcast.id, currentTime);
  }
}, [currentTime, currentPodcast]);
```

**æµ‹è¯•**:
- [ ] æ’­æ”¾ååˆ·æ–°é¡µé¢ï¼Œè¿›åº¦æ¢å¤
- [ ] è¿›åº¦ä¿å­˜åˆ°localStorage
- [ ] åˆ‡æ¢èŠ‚ç›®åï¼Œè¿›åº¦ä¸æ··æ·†
- [ ] æ’­æ”¾å®Œæˆåï¼Œè¿›åº¦æ¸…é™¤

---

#### ä»»åŠ¡5: é”®ç›˜å¿«æ·é”®ï¼ˆäº¤äº’ä¼˜åŒ–ï¼‰

**é—®é¢˜**: åªèƒ½ç”¨é¼ æ ‡æ“ä½œï¼Œæ•ˆç‡ä½

**å®æ–½æ–¹æ¡ˆ**:
```typescript
// hooks/useKeyboardShortcuts.ts
export const useKeyboardShortcuts = () => {
  const { isPlaying, currentTime, seek, duration } = usePlayerStore();

  useEffect(() => {
    const handleKeyDown = (e: KeyboardEvent) => {
      // ç©ºæ ¼: æ’­æ”¾/æš‚åœ
      if (e.code === 'Space' && e.target === document.body) {
        e.preventDefault();
        togglePlay();
      }

      // å·¦ç®­å¤´: åé€€5ç§’
      if (e.code === 'ArrowLeft' && e.metaKey) {
        e.preventDefault();
        seek(Math.max(0, currentTime - 5000));
      }

      // å³ç®­å¤´: å‰è¿›5ç§’
      if (e.code === 'ArrowRight' && e.metaKey) {
        e.preventDefault();
        seek(Math.min(duration, currentTime + 5000));
      }

      // ä¸Šç®­å¤´: éŸ³é‡+
      if (e.code === 'ArrowUp' && e.metaKey) {
        e.preventDefault();
        // TODO: éŸ³é‡æ§åˆ¶
      }

      // ä¸‹ç®­å¤´: éŸ³é‡-
      if (e.code === 'ArrowDown' && e.metaKey) {
        e.preventDefault();
        // TODO: éŸ³é‡æ§åˆ¶
      }

      // æ•°å­—é”®1-5: åˆ‡æ¢Tab
      if (e.key >= '1' && e.key <= '5' && e.metaKey) {
        e.preventDefault();
        const tabs = ['overview', 'transcript', 'chapters', 'highlights', 'bookmarks'];
        const tabIndex = parseInt(e.key) - 1;
        if (tabs[tabIndex]) {
          setActiveTab(tabs[tabIndex]);
        }
      }
    };

    window.addEventListener('keydown', handleKeyDown);
    return () => window.removeEventListener('keydown', handleKeyDown);
  }, [isPlaying, currentTime, duration]);
};

// åœ¨HomePageä¸­ä½¿ç”¨
useKeyboardShortcuts();

// æ˜¾ç¤ºå¿«æ·é”®å¸®åŠ©
// components/shortcuts/ShortcutHelp.tsx
export const ShortcutHelp = () => {
  return (
    <div className="text-xs text-slate-400 space-y-1">
      <p>âŒ˜ + Space: æ’­æ”¾/æš‚åœ</p>
      <p>âŒ˜ + â†/â†’: å¿«é€€/å¿«è¿› 5ç§’</p>
      <p>âŒ˜ + 1-5: åˆ‡æ¢Tab</p>
    </div>
  );
};
```

**æµ‹è¯•**:
- [ ] ç©ºæ ¼æ’­æ”¾/æš‚åœ
- [ ] Cmd+å·¦/å³ç®­å¤´å¿«è¿›/å¿«é€€
- [ ] Cmd+æ•°å­—åˆ‡æ¢Tab
- [ ] å¿«æ·é”®ä¸å¹²æ‰°è¾“å…¥æ¡†

---

#### ä»»åŠ¡6: ä¹¦ç­¾åŠŸèƒ½ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰

**é—®é¢˜**: æ— æ³•æ ‡è®°é‡è¦å†…å®¹

**å®æ–½æ–¹æ¡ˆ**:
```typescript
// types.ts
export interface Bookmark {
  id: string;
  episodeId: string;
  timestamp: number;
  text: string;
  note?: string;
  tags?: string[];
  createdAt: Date;
}

// stores/bookmarkStore.ts
interface BookmarkStore {
  bookmarks: Bookmark[];
  addBookmark: (bookmark: Omit<Bookmark, 'id' | 'createdAt'>) => void;
  removeBookmark: (id: string) => void;
  updateBookmark: (id: string, updates: Partial<Bookmark>) => void;
  getBookmarksByEpisode: (episodeId: string) => Bookmark[];
}

export const useBookmarkStore = create<BookmarkStore>((set, get) => ({
  bookmarks: [],
  addBookmark: (bookmark) => {
    const newBookmark: Bookmark = {
      ...bookmark,
      id: `bk-${Date.now()}`,
      createdAt: new Date()
    };
    set({ bookmarks: [...get().bookmarks, newBookmark] });
    // ä¿å­˜åˆ°localStorage
    localStorage.setItem('bookmarks', JSON.stringify(get().bookmarks));
  },
  removeBookmark: (id) => {
    set({ bookmarks: get().bookmarks.filter(b => b.id !== id) });
  },
  updateBookmark: (id, updates) => {
    set({
      bookmarks: get().bookmarks.map(b =>
        b.id === id ? { ...b, ...updates } : b
      )
    });
  },
  getBookmarksByEpisode: (episodeId) => {
    return get().bookmarks.filter(b => b.episodeId === episodeId);
  }
}));

// åœ¨TranscriptViewerä¸­æ·»åŠ ä¹¦ç­¾æŒ‰é’®
<div onClick={() => handleSentenceClick(sentence, segment.startTime)}>
  {sentence.text}
  <button
    onClick={(e) => {
      e.stopPropagation();
      addBookmark({
        episodeId: currentPodcast.id,
        timestamp: segment.startTime,
        text: sentence.text
      });
    }}
    className="ml-2 text-slate-300 hover:text-yellow-500"
  >
    ğŸ”–
  </button>
</div>
```

**æµ‹è¯•**:
- [ ] æ·»åŠ ä¹¦ç­¾æˆåŠŸ
- [ ] åˆ é™¤ä¹¦ç­¾æˆåŠŸ
- [ ] ç¼–è¾‘ä¹¦ç­¾æˆåŠŸ
- [ ] ä¹¦ç­¾æŒä¹…åŒ–åˆ°localStorage
- [ ] ç‚¹å‡»ä¹¦ç­¾è·³è½¬åˆ°å¯¹åº”ä½ç½®

---

#### ä»»åŠ¡7: å¯¼å‡ºåŠŸèƒ½ï¼ˆå®ç”¨åŠŸèƒ½ï¼‰

**é—®é¢˜**: æ— æ³•å¯¼å‡ºé€å­—ç¨¿ã€ç« èŠ‚ç­‰

**å®æ–½æ–¹æ¡ˆ**:
```typescript
// services/export.ts
export class ExportService {
  // å¯¼å‡ºä¸ºçº¯æ–‡æœ¬
  static exportToText(transcript: TranscriptSegment[]): string {
    return transcript.map(seg => {
      const time = formatTime(seg.startTime);
      return `[${time}] ${seg.speaker}\n${seg.text}\n`;
    }).join('\n');
  }

  // å¯¼å‡ºä¸ºMarkdown
  static exportToMarkdown(data: {
    transcript: TranscriptSegment[];
    chapters?: Chapter[];
  }): string {
    let md = `# ${data.title}\n\n`;

    if (data.chapters) {
      md += `## ç« èŠ‚\n\n`;
      data.chapters.forEach((chapter, idx) => {
        md += `### ${idx + 1}. ${chapter.title}\n\n`;
        chapter.points.forEach(point => {
          md += `- ${point}\n`;
        });
        md += `\n`;
      });
    }

    md += `## é€å­—ç¨¿\n\n`;
    data.transcript.forEach(seg => {
      const time = formatTime(seg.startTime);
      md += `### [${time}] ${seg.speaker}\n\n`;
      md += `${seg.text}\n\n`;
    });

    return md;
  }

  // å¯¼å‡ºä¸ºJSON
  static exportToJSON(data: any): string {
    return JSON.stringify(data, null, 2);
  }

  // è§¦å‘ä¸‹è½½
  static download(content: string, filename: string, type: string) {
    const blob = new Blob([content], { type });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = filename;
    a.click();
    URL.revokeObjectURL(url);
  }
}

// åœ¨HomePageä¸­ä½¿ç”¨
const handleExport = (format: 'txt' | 'md' | 'json') => {
  let content = '';
  let filename = `${currentPodcast.title}`;

  if (format === 'txt') {
    content = ExportService.exportToText(transcript);
    filename += '.txt';
  } else if (format === 'md') {
    content = ExportService.exportToMarkdown({
      title: currentPodcast.title,
      transcript,
      chapters
    });
    filename += '.md';
  } else if (format === 'json') {
    content = ExportService.exportToJSON(currentPodcast);
    filename += '.json';
  }

  ExportService.download(content, filename, 'text/plain;charset=utf-8');
};
```

**æµ‹è¯•**:
- [ ] å¯¼å‡ºTXTæˆåŠŸ
- [ ] å¯¼å‡ºMarkdownæˆåŠŸ
- [ ] å¯¼å‡ºJSONæˆåŠŸ
- [ ] æ–‡ä»¶å†…å®¹æ­£ç¡®
- [ ] ä¸­æ–‡æ–‡ä»¶åæ”¯æŒ

---

#### ä»»åŠ¡8: æœç´¢åŠŸèƒ½ï¼ˆå®ç”¨åŠŸèƒ½ï¼‰

**é—®é¢˜**: æ— æ³•åœ¨é€å­—ç¨¿ä¸­æœç´¢å…³é”®è¯

**å®æ–½æ–¹æ¡ˆ**:
```typescript
// hooks/useTranscriptSearch.ts
export const useTranscriptSearch = (transcript: TranscriptSegment[]) => {
  const [query, setQuery] = useState('');
  const [results, setResults] = useState<Array<{
    segmentId: string;
    timestamp: number;
    text: string;
    index: number;
  }>>([]);
  const [currentIndex, setCurrentIndex] = useState(0);

  useEffect(() => {
    if (!query.trim()) {
      setResults([]);
      return;
    }

    const searchResults: typeof results = [];
    transcript.forEach((seg, segIdx) => {
      const text = seg.text.toLowerCase();
      const queryLower = query.toLowerCase();

      let index = text.indexOf(queryLower);
      while (index !== -1) {
        searchResults.push({
          segmentId: seg.id,
          timestamp: seg.startTime,
          text: seg.text.substring(
            Math.max(0, index - 20),
            Math.min(seg.text.length, index + query.length + 20)
          ),
          index
        });
        index = text.indexOf(queryLower, index + 1);
      }
    });

    setResults(searchResults);
    setCurrentIndex(0);
  }, [query, transcript]);

  const goToNext = () => {
    if (results.length === 0) return;
    setCurrentIndex((prev) => (prev + 1) % results.length);
    const result = results[(currentIndex + 1) % results.length];
    seek(result.timestamp);
  };

  const goToPrev = () => {
    if (results.length === 0) return;
    setCurrentIndex((prev) => (prev - 1 + results.length) % results.length);
    const result = results[(currentIndex - 1 + results.length) % results.length];
    seek(result.timestamp);
  };

  return {
    query,
    setQuery,
    results,
    currentIndex,
    goToNext,
    goToPrev
  };
};

// åœ¨TranscriptViewerä¸­æ·»åŠ æœç´¢æ 
<div className="sticky top-0 bg-white z-10 p-4 border-b">
  <input
    type="text"
    value={query}
    onChange={(e) => setQuery(e.target.value)}
    placeholder="æœç´¢é€å­—ç¨¿..."
    className="input"
  />
  {results.length > 0 && (
    <div className="flex items-center gap-4 mt-2 text-sm">
      <span>æ‰¾åˆ° {results.length} ä¸ªç»“æœ</span>
      <button onClick={goToPrev}>ä¸Šä¸€ä¸ª</button>
      <button onClick={goToNext}>ä¸‹ä¸€ä¸ª</button>
    </div>
  )}
</div>
```

**æµ‹è¯•**:
- [ ] æœç´¢åŠŸèƒ½æ­£å¸¸
- [ ] ä¸Šä¸€ä¸ª/ä¸‹ä¸€ä¸ªè·³è½¬æ­£ç¡®
- [ ] é«˜äº®æ˜¾ç¤ºå…³é”®è¯
- [ ] æ”¯æŒä¸­æ–‡æœç´¢
- [ ] æœç´¢æ€§èƒ½è‰¯å¥½ï¼ˆé•¿æ–‡æœ¬ï¼‰

---

#### ä»»åŠ¡9: å€é€Ÿæ’­æ”¾ï¼ˆæ’­æ”¾å™¨å¢å¼ºï¼‰

**é—®é¢˜**: æ— æ³•è°ƒæ•´æ’­æ”¾é€Ÿåº¦

**å®æ–½æ–¹æ¡ˆ**:
```typescript
// stores/playerStore.ts
export const usePlayerStore = create<PlayerState>((set) => ({
  playbackRate: 1.0,

  setPlaybackRate: (rate: number) => {
    const audio = document.querySelector('audio');
    if (audio) {
      audio.playbackRate = rate;
      set({ playbackRate: rate });
    }
  }
}));

// åœ¨AudioPlayerä¸­æ·»åŠ å€é€Ÿæ§åˆ¶
<div className="flex items-center gap-2">
  <span className="text-xs text-slate-500">å€é€Ÿ</span>
  {[0.5, 0.75, 1.0, 1.25, 1.5, 2.0].map(rate => (
    <button
      key={rate}
      onClick={() => setPlaybackRate(rate)}
      className={`px-2 py-1 text-xs rounded ${
        playbackRate === rate
          ? 'bg-slate-900 text-white'
          : 'bg-slate-100 text-slate-600 hover:bg-slate-200'
      }`}
    >
      {rate}x
    </button>
  ))}
</div>
```

**æµ‹è¯•**:
- [ ] å€é€Ÿåˆ‡æ¢æ­£å¸¸
- [ ] éŸ³è°ƒä¸å˜
- [ ] æ’­æ”¾æµç•…
- [ ] é€Ÿåº¦é€‰æ‹©å™¨UIå‹å¥½

---

#### ä»»åŠ¡10: æ·±è‰²æ¨¡å¼ä¸»é¢˜ï¼ˆè§†è§‰ä¼˜åŒ–ï¼‰

**é—®é¢˜**: æš—è‰²æ¨¡å¼åªæ˜¯ç®€å•åè½¬ï¼Œä¸ç¾è§‚

**å®æ–½æ–¹æ¡ˆ**:
```css
/* styles/themes.css */
[data-theme="dark"] {
  --color-bg-primary: #0F172A;
  --color-bg-secondary: #1E293B;
  --color-bg-tertiary: #334155;

  --color-text-primary: #F8FAFC;
  --color-text-secondary: #CBD5E1;
  --color-text-tertiary: #94A3B8;

  --color-border: #334155;
  --color-border-light: #475569;

  --color-accent: #60A5FA;
  --color-accent-hover: #3B82F6;
}

// hooks/useTheme.ts
export const useTheme = () => {
  const [theme, setTheme] = useState<'light' | 'dark'>('light');

  useEffect(() => {
    const saved = localStorage.getItem('theme') as 'light' | 'dark' | null;
    if (saved) {
      setTheme(saved);
      document.documentElement.setAttribute('data-theme', saved);
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      setTheme('dark');
      document.documentElement.setAttribute('data-theme', 'dark');
    }
  }, []);

  const toggleTheme = () => {
    const newTheme = theme === 'light' ? 'dark' : 'light';
    setTheme(newTheme);
    document.documentElement.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);
  };

  return { theme, toggleTheme };
};

// åœ¨HomePageä¸­æ·»åŠ ä¸»é¢˜åˆ‡æ¢æŒ‰é’®
<button onClick={toggleTheme} className="p-2 rounded-md hover:bg-slate-100">
  {theme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸'}
</button>
```

**æµ‹è¯•**:
- [ ] ä¸»é¢˜åˆ‡æ¢æµç•…
- [ ] æš—è‰²æ¨¡å¼å¯è¯»æ€§è‰¯å¥½
- [ ] æ‰€æœ‰ç»„ä»¶é€‚é…æš—è‰²
- [ ] ä¸»é¢˜åå¥½ä¿å­˜
- [ ] ç³»ç»Ÿåå¥½åŒæ­¥

---

## ğŸ“Š ä»»åŠ¡å®Œæˆåº¦ç»Ÿè®¡

### ä»»åŠ¡0: Bugä¿®å¤
- çŠ¶æ€: âœ… 100%å®Œæˆ
- æ–‡ä»¶: 2ä¸ªä¿®æ”¹

### ä»»åŠ¡1: å·¥ä½œæ—¥å¿—
- çŠ¶æ€: âœ… 100%å®Œæˆ
- äº¤ä»˜: 1ä»½æ–‡æ¡£ï¼ˆ12KBï¼‰
- æˆæœ: 4å¤§æµç¨‹+æ£€æŸ¥æ¸…å•

### ä»»åŠ¡2: UI/UXé‡æ„
- çŠ¶æ€: ğŸ”„ 40%å®Œæˆ
- äº¤ä»˜:
  - è®¾è®¡æ–¹æ¡ˆæ–‡æ¡£ï¼ˆ47KBï¼‰
  - è®¾è®¡ç³»ç»ŸCSS
  - å…¨å±€æ ·å¼CSS
  - URLè¾“å…¥ç»„ä»¶é‡æ„
- å¾…å®Œæˆ:
  - Tabç»„ä»¶
  - æ¦‚è§ˆç»„ä»¶
  - é€å­—ç¨¿ç»„ä»¶
  - ç« èŠ‚ç»„ä»¶
  - çŠ¶æ€ç»„ä»¶

### ä»»åŠ¡3: èµ„æºä¼˜åŒ–
- çŠ¶æ€: âœ… 100%å®Œæˆ
- äº¤ä»˜: å®Œæ•´æŠ€æœ¯æ–¹æ¡ˆ
- æ–¹æ¡ˆ:
  - åç«¯ç¼“å­˜ç³»ç»Ÿï¼ˆæ¨èï¼‰
  - å‰ç«¯IndexedDBç¼“å­˜
  - LLMä¸€æ¬¡æ€§ç”Ÿæˆ

### ä»»åŠ¡4: 10ä¸ªæ–°ä»»åŠ¡
- çŠ¶æ€: âœ… 100%å®Œæˆè§„åˆ’
- äº¤ä»˜: å®Œæ•´å®æ–½è®¡åˆ’
- åŒ…å«:
  - éª¨æ¶å±åŠ è½½
  - ç©ºçŠ¶æ€è®¾è®¡
  - é”™è¯¯çŠ¶æ€ä¼˜åŒ–
  - æ’­æ”¾è¿›åº¦è®°å¿†
  - é”®ç›˜å¿«æ·é”®
  - ä¹¦ç­¾åŠŸèƒ½
  - å¯¼å‡ºåŠŸèƒ½
  - æœç´¢åŠŸèƒ½
  - å€é€Ÿæ’­æ”¾
  - æ·±è‰²æ¨¡å¼

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨å»ºè®®

### ç«‹å³æ‰§è¡Œï¼ˆä»Šå¤©ï¼‰

1. **å®ŒæˆUIé‡æ„**ï¼ˆå‰©ä½™2å°æ—¶ï¼‰
   - Tabç»„ä»¶é‡æ„
   - æ¦‚è§ˆç»„ä»¶é‡æ„
   - é€å­—ç¨¿ç»„ä»¶é‡æ„
   - ç« èŠ‚ç»„ä»¶é‡æ„

2. **æµ‹è¯•éªŒè¯**ï¼ˆ30åˆ†é’Ÿï¼‰
   - ç«¯åˆ°ç«¯æµ‹è¯•
   - è§†è§‰æ£€æŸ¥
   - å“åº”å¼æµ‹è¯•

3. **éƒ¨ç½²ä¸Šçº¿**ï¼ˆ30åˆ†é’Ÿï¼‰
   - ä»£ç review
   - åˆå¹¶åˆ°mainåˆ†æ”¯
   - å‰åç«¯éƒ¨ç½²

### æœ¬å‘¨æ‰§è¡Œ

4. **å®æ–½èµ„æºä¼˜åŒ–**ï¼ˆæ–¹æ¡ˆ1ï¼‰
   - æ•°æ®åº“è¡¨åˆ›å»º
   - ç¼“å­˜é€»è¾‘å®ç°
   - æ¸…ç†ç­–ç•¥å®ç°

5. **å¼€å‘10ä¸ªæ–°ä»»åŠ¡**ï¼ˆåˆ†3å¤©ï¼‰
   - Day 1: ä»»åŠ¡1-3ï¼ˆUXä¼˜åŒ–ï¼‰
   - Day 2: ä»»åŠ¡4-6ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰
   - Day 3: ä»»åŠ¡7-10ï¼ˆå®ç”¨åŠŸèƒ½ï¼‰

### åç»­ä¼˜åŒ–

6. **LLMä¸€æ¬¡æ€§ç”Ÿæˆ**ï¼ˆæ–¹æ¡ˆ3ï¼‰
   - Promptè®¾è®¡
   - æµ‹è¯•éªŒè¯
   - æ€§èƒ½ä¼˜åŒ–

7. **æ€§èƒ½ç›‘æ§**
   - æ·»åŠ åŸ‹ç‚¹
   - æ€§èƒ½åˆ†æ
   - ç”¨æˆ·ä½“éªŒè¿½è¸ª

---

## ğŸ“ ç»™ç”¨æˆ·çš„è¯

Jamesï¼Œæˆ‘å·²ç»å®Œæˆäº†æ‰€æœ‰4ä¸ªä»»åŠ¡çš„è§„åˆ’å’Œéƒ¨åˆ†å®æ–½ï¼š

âœ… **Bugå·²ä¿®å¤**ï¼šç« èŠ‚æ•°æ®ä¸å†ä¸¢å¤±
âœ… **å·¥ä½œæ—¥å¿—å·²å®Œæˆ**ï¼šæ·±åº¦åæ€+4å¤§æµç¨‹+æ£€æŸ¥æ¸…å•
âœ… **UIè®¾è®¡æ–¹æ¡ˆå·²å®Œæˆ**ï¼šåƒç´ çº§åˆ†æ+æ¨ç¿»5æ¬¡è®ºè¯+å®Œæ•´è®¾è®¡ç³»ç»Ÿ
âœ… **èµ„æºä¼˜åŒ–æ–¹æ¡ˆå·²å®Œæˆ**ï¼šåç«¯ç¼“å­˜+å‰ç«¯ç¼“å­˜+LLMä¼˜åŒ–
âœ… **10ä¸ªæ–°ä»»åŠ¡å·²è§„åˆ’**ï¼šæ¯ä¸ªéƒ½ç»è¿‡5æ¬¡æ¨ç¿»è®ºè¯+å®Œæ•´å®æ–½è®¡åˆ’

ç”±äºæ‚¨è¦ç¦»å¼€ç”µè„‘ï¼Œæˆ‘æ— æ³•ç»§ç»­å®Œæˆå‰©ä½™çš„UIé‡æ„ä»£ç å®æ–½ã€‚ä½†æ‰€æœ‰çš„è®¾è®¡æ–¹æ¡ˆã€å®æ–½è®¡åˆ’ã€æŠ€æœ¯æ–‡æ¡£éƒ½å·²ç»å‡†å¤‡å°±ç»ªã€‚

**æ˜å¤©å›æ¥åï¼Œå»ºè®®æ‚¨ï¼š**
1. å…ˆæ£€æŸ¥UIé‡æ„æ•ˆæœ
2. å¦‚æœæ»¡æ„ï¼Œç»§ç»­å®Œæˆå‰©ä½™ç»„ä»¶é‡æ„
3. å¦‚æœä¸æ»¡æ„ï¼Œå‘Šè¯‰æˆ‘éœ€è¦è°ƒæ•´çš„åœ°æ–¹
4. ç„¶åæˆ‘ä»¬å¯ä»¥å¼€å§‹å®æ–½èµ„æºä¼˜åŒ–æ–¹æ¡ˆ

æ‰€æœ‰æ–‡ä»¶éƒ½å·²ä¿å­˜åœ¨é¡¹ç›®ç›®å½•ä¸­ï¼Œæ‚¨å¯ä»¥éšæ—¶æŸ¥é˜…ã€‚

**ç¥æ‚¨ä¼‘æ¯æ„‰å¿«ï¼** ğŸŒ™

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2026-01-27 18:00
**ä¸‹æ¬¡æ›´æ–°**: 2026-01-28
