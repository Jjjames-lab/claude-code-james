# 实现指南 - 可视化精英协作系统

> **版本**：v0.1 → MVP
> **目标**：从 HTML Demo 到可用系统

---

## 🎯 分阶段实施计划

### 阶段1: MVP 手动更新（今晚-明天）

**目标**：验证可视化价值

**实施步骤**：
1. ✅ 创建静态 HTML Demo（已完成）
2. ⏳ 创建 State JSON 文件
3. ⏳ 创建更新脚本
4. ⏳ 角色使用指南

**数据文件结构**：
```
_system/
├── demo.html          # 看板界面
├── state.json         # 角色状态（手动更新）
├── events.json        # 事件流（手动追加）
└── update.html        # 更新界面（简化版）
```

### 阶段2: 半自动更新（明天-后天）

**目标**：减少手动操作

**新增功能**：
- 角色通过简单界面更新状态
- 自动刷新看板（每30秒）
- 事件流自动追加

**新增文件**：
```
_system/
├── update.html        # 简单更新界面
├── refresh.js         # 自动刷新脚本
└── events.log         # 事件日志
```

### 阶段3: 智能协调（后天）

**目标**：自动化协调

**新增功能**：
- 任务队列管理
- 自动通知
- 冲突检测

**新增组件**：
- Task Queue Manager
- Notification System
- Conflict Detector

---

## 💾 MVP 数据文件设计

### state.json（角色状态）

```json
{
  "lastUpdate": "2026-01-20T19:35:00",
  "roles": [
    {
      "id": "architect",
      "name": "架构师",
      "status": "working",
      "currentTask": {
        "name": "多引擎架构设计",
        "progress": 60,
        "target": "架构设计文档",
        "spentMinutes": 5,
        "estimatedMinutes": 35,
        "needs": [
          {
            "type": "document",
            "from": "backend",
            "status": "provided",
            "url": "_shared/07_doubao_asr_implementation.md"
          }
        ]
      },
      "queue": [],
      "blocking": []
    },
    {
      "id": "frontend",
      "name": "前端工程师",
      "status": "idle",
      "currentTask": null,
      "queue": ["点击跳转功能", "自动滚动", "笔记功能"],
      "blocking": []
    },
    {
      "id": "backend",
      "name": "后端工程师",
      "status": "working",
      "currentTask": {
        "name": "豆包 ASR 研究",
        "progress": 90,
        "target": "实现指南文档",
        "spentMinutes": 25,
        "estimatedMinutes": 5
      }
    },
    {
      "id": "product",
      "name": "产品经理",
      "status": "idle",
      "currentTask": null
    },
    {
      "id": "ui",
      "name": "UI/UX 设计师",
      "status": "idle",
      "currentTask": null
    }
  ],
  "events": [
    {
      "time": "19:35",
      "type": "task-completed",
      "from": "backend",
      "to": ["architect", "supervisor"],
      "message": "豆包ASR研究完成 (v2.0)"
    },
    {
      "time": "19:25",
      "type": "task-started",
      "from": "architect",
      "message": "开始多引擎架构设计"
    },
    {
      "time": "19:15",
      "type": "warning",
      "from": "supervisor",
      "to": ["architect", "backend"],
      "message": "发现工作冲突，已协调"
    }
  ]
}
```

---

## 🔧 如何更新状态

### 方式A: 手动编辑 JSON（MVP）

**角色完成任务后**：
1. 打开 `state.json`
2. 更新自己的 status, progress
3. 添加新事件到 events 数组
4. 保存

**你查看进度**：
1. 打开 `demo.html`
2. 刷新浏览器
3. 看到最新状态

### 方式B: 简单更新界面（V2）

**创建 `update.html`**：
```html
<!-- 简单的表单界面 -->
<select id="roleSelect">
  <option value="architect">架构师</option>
  <option value="backend">后端</option>
  ...
</select>

<select id="statusSelect">
  <option value="idle">空闲</option>
  <option value="working">工作中</option>
  <option value="blocked">阻塞</option>
</select>

<input id="taskName" placeholder="任务名称">

<input type="number" id="progress" placeholder="进度 %">

<button onclick="updateState()">更新</button>

<script>
function updateState() {
  // 读取 state.json
  // 更新对应字段
  // 写回 state.json
  // 提示"更新成功"
}
</script>
```

### 方式C: 命令行工具（V3）

**创建脚本**：`update_state.sh`
```bash
#!/bin/bash
# 用法: ./update_state.sh architect working "多引擎架构" 60

ROLE=$1
STATUS=$2
TASK=$3
PROGRESS=$4

# 更新 state.json
# ...
```

---

## 📊 实时更新方案

### 方案1: 简单轮询（MVP）

**实现**：
```javascript
// 在 demo.html 中
setInterval(() => {
  fetch('state.json')
    .then(r => r.json())
    .then(data => updateDashboard(data))
}, 30000); // 每30秒
```

**优点**：
- ✅ 简单
- ✅ 无需服务器
- ✅ 可行

**缺点**：
- ⚠️ 最多30秒延迟
- ⚠️ 需要手动刷新

### 方案2: 自动刷新（V2）

**实现**：
```html
<meta http-equiv="refresh" content="30">
```

**优点**：
- ✅ 更简单
- ✅ 自动刷新

**缺点**：
- ⚠️ 整个页面刷新
- ⚠️ 闪烁

### 方案3: Server-Sent Events（V3）

**需要**：
- Python/Node.js 服务器
- SSE 支持

**优点**：
- ✅ 真正实时
- ✅ 平滑更新

**缺点**：
- ⚠️ 复杂
- ⚠️ 需要服务器

**推荐**：先用方案1，验证需求后再升级

---

## 🎭 角色使用指南

### 角色启动工作前

**检查清单**：
```
1. 打开 demo.html，查看全局状态
2. 确认自己的任务
3. 确认依赖是否满足
4. 确认没有冲突
```

### 角色工作中

**进度更新**：
- �完成25%进度 → 更新一次
- 遇到问题 → 立即标记 status = "blocked"
- 需要资源 → 在 needs 中添加

### 角色完成任务后

**必须做**：
```
1. 更新 status = "idle"
2. progress = 100
3. 添加事件到 events：
   {
     "time": "19:35",
     "type": "task-completed",
     "from": "backend",
     "to": ["architect"],
     "message": "豆包ASR研究完成"
   }
4. 通知下一个角色
```

---

## 🤖 智能协调逻辑（未来）

### 自动通知机制

**触发条件**：
- 角色完成任务 → status 变为 idle
- 检查任务队列
- 找到下一个任务
- 通知下一个角色

**实现**：
```python
def check_and_notify():
  # 读取 state.json
  state = load_state()

  # 遍历角色
  for role in state['roles']:
    if role['status'] == 'idle':
      # 检查任务队列
      next_task = find_next_task_for(role['id'])
      if next_task:
        # 通知
        send_notification(role['id'], next_task)
```

### 冲突检测

**检测逻辑**：
```
两个角色同时想做同一个任务？
→ 检测到冲突
→ 创建 Challenge
→ 通知双方
→ 你做决策
```

---

## 📝 文件组织（推荐）

```
Pod/
├── _system/                    # 新增：系统文件夹
│   ├── demo.html              # 看板界面
│   ├── state.json             # 状态数据
│   ├── events.json            # 事件流
│   ├── update.html            # 更新界面
│   └── README.md              # 系统说明
├── _shared/                   # 共享文件夹
│   ├── 00_project_status.md
│   ├── 01_api_spec.json
│   └── ...
├── 角色/
│   ├── 架构师/
│   ├── 后端Backend/
│   └── ...
└── 系统设计_可视化精英协作系统/
    ├── 00_深度思考.md
    ├── 01_系统架构.md
    └── 02_实现指南.md (本文件)
```

---

## 🎯 今晚的下一步

### 立即做
1. ✅ 深度思考文档
2. ✅ 系统架构文档
3. ✅ HTML Demo
4. ⏳ state.json 示例
5. ⏳ 简单更新界面

### 明天做
1. 实现自动刷新
2. 创建更新界面
3. 角色使用指南
4. 测试和反馈

### 后天做
1. 智能协调逻辑
2. 自动通知
3. 冲突检测
4. 质疑系统

---

## 💭 持续反思

### 质疑1: HTML 是最佳方案吗？

**问题**：
- 需要浏览器打开
- 需要手动刷新
- 不能后台运行

**替代方案**：
- Markdown + 实时预览？
- 纯命令行界面（TUI）？
- VS Code 插件？

**重新思考**：
- 用户要的是"可视化"
- HTML 最直观
- 先验证效果
- 后续优化

### 质疑2: 手动更新能接受吗？

**问题**：
- 角色会记得更新吗？
- 会不会太麻烦？
- 会不会忘记？

**解决方案**：
- 在角色 README 中强制要求
- 在任务完成提醒中强调
- 定期检查

**优化方向**：
- 简化更新流程（一键更新）
- 自动检测进度（读取文件修改时间）
- 被动更新（我定期读取 WORK_LOG.md）

### 质疑3: 这个系统能解决核心问题吗？

**核心问题**：
1. 信息不透明 → ✅ 看板解决
2. 工作重复 → ✅ 任务队列解决
3. 缺乏质疑 → ⏳ 需要机制
4. 资源浪费 → ✅ 智能协调解决

**评估**：
- MVP 解决 1、2（大部分）
- V2 解决 3、4
- 方向正确

---

## 🚀 快速启动

### 你今晚就可以

1. 查看 HTML Demo
   ```bash
   open /Users/tbingy/Desktop/Claude\ Code/Coding/Pod/系统设计_可视化精英协作系统/demo.html
   ```

2. 看到可视化看板
   - 5个角色状态
   - 进度条
   - 事件流
   - 任务队列

3. 验证价值
   - 是否比文本更直观？
   - 是否能快速了解全局？
   - 是否能发现问题？

4. 给我反馈
   - 有哪些不够好？
   - 还想看到什么？
   - 需要调整什么？

---

## 📞 后续

**明天我们讨论**：
- 看板效果如何
- 是否需要调整
- 如何实现自动更新
- 如何让角色主动更新

**今晚我继续**：
- 深度思考
- 优化设计
- 创建更多文档
- 推倒重来

---

**未完待续...**
